## Основные команды psql / PostgreSQL

### Подключение к серверу и базам
- **Подключиться к серверу под пользователем**:
    'sudo -u postgres psql'
  - `psql -U имя_пользователя`
  - `psql -U имя_пользователя -h хост -p порт`
- **Подключиться сразу к базе**:
  - `psql -U имя_пользователя -d имя_базы`
- **Сменить базу внутри psql**:
  - `\c имя_базы`

### Общая навигация и справка в psql
- **Показать список доступных метакоманд**:
  - `\?`
- **Справка по SQL-командам**:
  - `\h`
  - `\h SELECT`, `\h INSERT` и т.п. — подробная справка по конкретной SQL-команде
- **Выйти из psql**:
  - `\q`

### Базы данных
- **Показать список баз данных**:
  - `\l` или `\list`
- **Показать текущую базу**:
  - `SELECT current_database();`

### Пользователи и роли
- **Показать всех пользователей (роли)**:
  - `\du`
- **Показать пользователей через SQL**:
  - `SELECT usename FROM pg_user;`

### Схемы
- **Показать все схемы в текущей базе**:
  - `\dn`
- **Показать путь поиска схем (search_path)**:
  - `SHOW search_path;`

### Таблицы и другие объекты
- **Показать все таблицы в текущей схеме**:
  - `\dt`
- **Показать таблицы во всех схемах**:
  - `\dt *.*`
- **Показать только таблицы в конкретной схеме**:
  - `\dt имя_схемы.*`
- **Показать последовательности**:
  - `\ds`
- **Показать представления**:
  - `\dv`

### Структура таблиц (столбцы, типы, ключи)
- **Показать структуру конкретной таблицы** (колонки, типы, ограничения):
  - `\d имя_таблицы`
- **Показать структуру таблицы с дополнительной информацией**:
  - `\d+ имя_таблицы`
- **Вывести список столбцов таблицы через SQL**:
  - `SELECT column_name, data_type
    FROM information_schema.columns
    WHERE table_name = 'имя_таблицы';`

### Данные (строки в таблицах)
- **Показать все строки таблицы** (осторожно с большими таблицами):
  - `SELECT * FROM имя_таблицы;`
- **Ограничить количество строк**:
  - `SELECT * FROM имя_таблицы LIMIT 10;`
- **Отфильтровать строки по условию**:
  - `SELECT * FROM имя_таблицы WHERE столбец = значение;`
- **Посчитать количество строк**:
  - `SELECT COUNT(*) FROM имя_таблицы;`

### Информация о соединении и текущем пользователе
- **Показать текущего пользователя**:
  - `SELECT current_user;`
- **Показать версию сервера PostgreSQL**:
  - `SELECT version();`

### Настройки вывода в psql (удобство)
- **Включить/выключить развёрнутый вывод строк** (по одной строке вертикально):
  - `\x` (переключатель)
- **Показать/скрыть заголовки столбцов**:
  - `\t` (переключатель)
- **Сохранить результат запроса в файл**:
  - `\o путь_к_файлу` — направить вывод в файл
  - `\o` — вернуть вывод обратно в терминал

### Частые сценарии "от нуля" (пошагово)
- **1. Подключиться к серверу**:
  - `psql -U postgres`
- **2. Посмотреть все базы**:
  - `\l`
- **3. Перейти в нужную базу**:
  - `\c имя_базы`
- **4. Посмотреть схемы и таблицы**:
  - `\dn`
  - `\dt` или `\dt *.*`
- **5. Посмотреть структуру интересующей таблицы**:
  - `\d имя_таблицы`
- **6. Посмотреть данные**:
  - `SELECT * FROM имя_таблицы LIMIT 20;`

### Что ещё может пригодиться
- **Показать последние выполненные команды (история в оболочке, не в psql)**:
  - В Linux: `history | grep psql`
- **Запустить SQL-скрипт из файла в psql**:
  - `\i путь_к_файлу.sql`
- **Выполнить единичный SQL-запрос без входа в интерактивный режим**:
  - `psql -U имя_пользователя -d имя_базы -c "SELECT 1;"`

Все команды вида `\...` выполняются **внутри psql**, а SQL-запросы (`SELECT`, `INSERT`, `UPDATE`, `DELETE`, `SHOW`, `ALTER` и т.д.) — это стандартный SQL, который тоже вводится в psql и завершается точкой с запятой `;`. 

LEXXES, [07.12.2025 21:15]
зайти в sql = sudo -u postgres psql

LEXXES, [07.12.2025 21:15]
2. Посмотреть список таблиц в этой БД = \dt

LEXXES, [07.12.2025 21:16]
1. Зайти в нужную базу = \c workshop_db

LEXXES, [07.12.2025 21:16]
3. Посмотреть столбцы конкретной таблицы = \d users

flyway -configFiles=flyway.conf migrate
flyway -configFiles=flyway.conf clean